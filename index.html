<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Smart To-Do List</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Direct Kimi AI integration - no external dependencies -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-gray-100 min-h-screen">
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- Header -->
        <header class="text-center mb-8" role="banner">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">
                <i class="fas fa-tasks text-blue-600"></i>
                My Smart To-Do List
            </h1>
            <p class="text-gray-600">Organize your tasks with priorities and due dates</p>
        </header>

        <main id="main-content" class="bg-transparent" role="main" aria-label="My task manager">
        <!-- Add Task Form -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-8" aria-labelledby="add-task-heading">
            <h2 id="add-task-heading" class="text-xl font-semibold mb-4 text-gray-800">Add New Task</h2>
            <form id="task-form" class="space-y-4" aria-describedby="task-form-help">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <!-- Task Description -->
                    <div class="md:col-span-2">
                        <label for="task-input" class="block text-sm font-medium text-gray-700 mb-1">Task Description</label>
                        <input 
                            type="text" 
                            id="task-input" 
                            placeholder="Enter your task..." 
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            required
                        >
                    </div>

                    <!-- Priority Selection -->
                    <div>
                        <label for="priority-select" class="block text-sm font-medium text-gray-700 mb-1">Priority</label>
                        <select 
                            id="priority-select" 
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        >
                            <option value="low">Low Priority</option>
                            <option value="medium" selected>Medium Priority</option>
                            <option value="high">High Priority</option>
                        </select>
                    </div>

                    <!-- Due Date -->
                    <div>
                        <label for="due-date" class="block text-sm font-medium text-gray-700 mb-1">Due Date</label>
                        <input 
                            type="date" 
                            id="due-date" 
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        >
                    </div>

                    <!-- Category Selection -->
                    <div>
                        <label for="category-select" class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                        <select
                            id="category-select"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        >
                            <option value="general" selected>General</option>
                            <option value="work">Work</option>
                            <option value="personal">Personal</option>
                            <option value="shopping">Shopping</option>
                            <option value="health">Health</option>
                        </select>
                    </div>
                </div>

                <button 
                    type="submit" 
                    class="w-full md:w-auto bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 transition duration-200 font-medium"
                    aria-label="Add the task to your list"
                >
                    <i class="fas fa-plus mr-2"></i>Add Task
                </button>
                <p id="task-form-help" class="sr-only">Enter a task description, choose an optional priority and due date, then select Add Task.</p>
            </form>
        </div>

        <!-- Filter and Sort Controls -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-8">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                <div class="flex flex-col sm:flex-row gap-4">
                    <div>
                        <label for="filter-priority" class="block text-sm font-medium text-gray-700 mb-1">Filter by Priority</label>
                        <select 
                            id="filter-priority" 
                            class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        >
                            <option value="all">All Priorities</option>
                            <option value="high">High Priority</option>
                            <option value="medium">Medium Priority</option>
                            <option value="low">Low Priority</option>
                        </select>
                    </div>

                    <div>
                        <label for="sort-tasks" class="block text-sm font-medium text-gray-700 mb-1">Sort By</label>
                        <select 
                            id="sort-tasks" 
                            class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        >
                            <option value="priority">Priority</option>
                            <option value="date">Due Date</option>
                            <option value="created">Date Created</option>
                        </select>
                    </div>

                    <div>
                        <label for="filter-category" class="block text-sm font-medium text-gray-700 mb-1">Filter by Category</label>
                        <select
                            id="filter-category"
                            class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        >
                            <option value="all">All Categories</option>
                            <option value="general">General</option>
                            <option value="work">Work</option>
                            <option value="personal">Personal</option>
                            <option value="shopping">Shopping</option>
                            <option value="health">Health</option>
                        </select>
                    </div>
                </div>

                <div class="flex gap-2" role="group" aria-label="Task view filters">
                    <button 
                        id="show-all" 
                        aria-pressed="true"
                        class="px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition duration-200"
                    >
                        All Tasks
                    </button>
                    <button 
                        id="show-pending" 
                        aria-pressed="false"
                        class="px-4 py-2 bg-yellow-200 text-yellow-800 rounded-md hover:bg-yellow-300 transition duration-200"
                    >
                        Pending
                    </button>
                    <button 
                        id="show-completed" 
                        aria-pressed="false"
                        class="px-4 py-2 bg-green-200 text-green-800 rounded-md hover:bg-green-300 transition duration-200"
                    >
                        Completed
                    </button>
                </div>
            </div>
        </div>

        <!-- Task Statistics -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-8">
            <div class="bg-white rounded-lg shadow-md p-4 text-center">
                <div class="text-2xl font-bold text-blue-600" id="total-tasks">0</div>
                <div class="text-gray-600">Total Tasks</div>
            </div>
            <div class="bg-white rounded-lg shadow-md p-4 text-center">
                <div class="text-2xl font-bold text-yellow-600" id="pending-tasks">0</div>
                <div class="text-gray-600">Pending</div>
            </div>
            <div class="bg-white rounded-lg shadow-md p-4 text-center">
                <div class="text-2xl font-bold text-green-600" id="completed-tasks">0</div>
                <div class="text-gray-600">Completed</div>
            </div>
            <div class="bg-white rounded-lg shadow-md p-4 text-center">
                <div class="text-2xl font-bold text-red-600" id="overdue-tasks">0</div>
                <div class="text-gray-600">Overdue</div>
            </div>
        </div>

        <!-- Tasks List -->
        <div class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-xl font-semibold mb-4 text-gray-800">Your Tasks</h2>
            
            <!-- Empty State -->
            <div id="empty-state" class="text-center py-12 hidden" role="status" aria-live="polite" aria-hidden="true">
                <i class="fas fa-clipboard-list text-6xl text-gray-300 mb-4"></i>
                <h3 class="text-xl font-medium text-gray-500 mb-2">No tasks yet</h3>
                <p class="text-gray-400">Add your first task to get started!</p>
            </div>

            <!-- Tasks Container with Virtual Scroll Support -->
            <div id="tasks-scroll-container" class="tasks-scroll-wrapper" role="region" aria-live="polite" aria-busy="false" aria-label="Task list">
                <div id="virtual-spacer-top" class="virtual-spacer" aria-hidden="true"></div>
                <div id="tasks-container" class="space-y-4" role="feed" aria-live="polite" aria-atomic="false">
                    <!-- Tasks will be dynamically inserted here -->
                </div>
                <div id="virtual-spacer-bottom" class="virtual-spacer" aria-hidden="true"></div>
            </div>
        </div>
        </main>
    </div>

    <!-- Edit Task Modal -->
    <div id="edit-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full max-h-96 overflow-y-auto">
            <div class="p-6">
                <h3 class="text-lg font-semibold mb-4">Edit Task</h3>
                <form id="edit-form" class="space-y-4">
                    <div>
                        <label for="edit-task-input" class="block text-sm font-medium text-gray-700 mb-1">Task Description</label>
                        <input 
                            type="text" 
                            id="edit-task-input" 
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                            required
                        >
                    </div>
                    <div>
                        <label for="edit-priority-select" class="block text-sm font-medium text-gray-700 mb-1">Priority</label>
                        <select 
                            id="edit-priority-select" 
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        >
                            <option value="low">Low Priority</option>
                            <option value="medium">Medium Priority</option>
                            <option value="high">High Priority</option>
                        </select>
                    </div>
                    <div>
                        <label for="edit-category-select" class="block text-sm font-medium text-gray-700 mb-1">Category</label>
                        <select
                            id="edit-category-select"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        >
                            <option value="general">General</option>
                            <option value="work">Work</option>
                            <option value="personal">Personal</option>
                            <option value="shopping">Shopping</option>
                            <option value="health">Health</option>
                        </select>
                    </div>
                    <div>
                        <label for="edit-due-date" class="block text-sm font-medium text-gray-700 mb-1">Due Date</label>
                        <input 
                            type="date" 
                            id="edit-due-date" 
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                        >
                    </div>
                    <div class="flex justify-end space-x-3 pt-4">
                        <button 
                            type="button" 
                            id="cancel-edit" 
                            class="px-4 py-2 text-gray-600 bg-gray-200 rounded-md hover:bg-gray-300 transition duration-200"
                        >
                            Cancel
                        </button>
                        <button 
                            type="submit" 
                            class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition duration-200"
                        >
                            Save Changes
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- AI Chat Assistant -->
    <div id="ai-chat-toggle" class="fixed bottom-6 right-6 z-40">
        <button class="bg-gradient-to-r from-purple-600 to-blue-600 text-white p-4 rounded-full shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300" aria-label="Open Shani task assistant" aria-controls="ai-chat-container" aria-expanded="false">
            <img src="images/shani_img.png" alt="Shani assistant avatar" class="assistant-avatar w-10 h-10" />
        </button>
    </div>

    <!-- AI Chat Interface -->
    <div id="ai-chat-container" class="fixed bottom-6 right-6 w-80 h-96 bg-white rounded-lg shadow-2xl border border-gray-200 z-50 transform translate-y-full opacity-0 transition-all duration-300 hidden" role="dialog" aria-modal="true" aria-label="Chat with Shani task assistant">
        <!-- Chat Header -->
        <div class="bg-gradient-to-r from-purple-600 to-blue-600 text-white p-4 rounded-t-lg">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-2">
                    <img src="images/shani_img.png" alt="" role="presentation" class="assistant-avatar w-8 h-8" />
                    <h3 class="font-semibold" id="chat-assistant-title">Shani My Task Assistant</h3>
                </div>
                <button id="chat-close" class="text-white hover:text-gray-200 transition-colors" aria-label="Close chat with Shani">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <p class="text-sm opacity-90 mt-1">Ask me to manage your tasks!</p>
        </div>

        <!-- Chat Messages -->
        <div id="chat-messages" class="flex-1 p-4 h-64 overflow-y-auto bg-gray-50" role="log" aria-live="polite" aria-atomic="false" aria-relevant="additions text">
            <div class="chat-message ai-message mb-3">
                <div class="flex items-start gap-2">
                    <div class="assistant-avatar-wrapper flex-shrink-0 mt-1">
                        <img src="images/shani_img.png" alt="" role="presentation" class="assistant-avatar w-8 h-8" />
                    </div>
                    <div class="bg-white p-3 rounded-lg shadow-sm max-w-xs">
                        <p class="text-sm">Hi! I'm Shani, your task assistant. I can help you manage tasks using natural language. Try saying:</p>
                        <ul class="text-xs mt-2 space-y-1 text-gray-600">
                            <li>â€¢ "Add buy groceries tomorrow"</li>
                            <li>â€¢ "What's due this week?"</li>
                            <li>â€¢ "Mark exercise as completed"</li>
                        </ul>
                        <p class="text-xs text-purple-600 font-medium mt-2">Powered by Kimi AI ðŸ¤–âœ¨</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat Input -->
        <div class="p-4 border-t border-gray-200 bg-white rounded-b-lg">
            <form id="chat-form" class="flex gap-2" role="search" aria-label="Chat with AI assistant">
                <label for="chat-input" class="sr-only">Type your message to Shani</label>
                <input 
                    type="text" 
                    id="chat-input" 
                    placeholder="Ask me about your tasks..."
                    class="flex-1 px-3 py-2 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent"
                    autocomplete="off"
                    aria-describedby="chat-help"
                    aria-label="Type your message to Shani"
                >
                <button 
                    type="submit" 
                    class="bg-purple-600 text-white px-3 py-2 rounded-md hover:bg-purple-700 transition-colors focus:ring-2 focus:ring-purple-500 focus:ring-offset-2"
                    aria-label="Send message"
                >
                    <i class="fas fa-paper-plane" aria-hidden="true"></i>
                </button>
            </form>
            <div id="chat-help" class="sr-only">You can ask Shani to add tasks, show your schedule, mark items complete, or get help. Use arrow keys to navigate previous messages.</div>
            <!-- Quick Access Actions -->
            <div class="mt-3 space-y-2">
                <div class="text-xs font-medium text-gray-600 mb-2">Quick Actions</div>
                <div class="grid grid-cols-2 gap-2">
                    <button class="quick-action-btn bg-blue-50 hover:bg-blue-100 text-blue-700 px-3 py-2 rounded text-xs font-medium transition-colors" data-action="show-pending" aria-label="Show pending tasks">
                        <i class="fas fa-clock mr-1"></i>Pending
                    </button>
                    <button class="quick-action-btn bg-green-50 hover:bg-green-100 text-green-700 px-3 py-2 rounded text-xs font-medium transition-colors" data-action="show-completed" aria-label="Show completed tasks">
                        <i class="fas fa-check-circle mr-1"></i>Completed
                    </button>
                    <button class="quick-action-btn bg-red-50 hover:bg-red-100 text-red-700 px-3 py-2 rounded text-xs font-medium transition-colors" data-action="show-overdue" aria-label="Show overdue tasks">
                        <i class="fas fa-exclamation-triangle mr-1"></i>Overdue
                    </button>
                    <button class="quick-action-btn bg-purple-50 hover:bg-purple-100 text-purple-700 px-3 py-2 rounded text-xs font-medium transition-colors" data-action="show-stats" aria-label="Show task statistics">
                        <i class="fas fa-chart-bar mr-1"></i>Stats
                    </button>
                </div>
                <div class="flex gap-1 mt-2">
                    <button class="quick-prompt text-xs bg-gray-100 hover:bg-gray-200 px-2 py-1 rounded transition-colors" data-prompt="Add workout session high priority tomorrow" tabindex="0">Add workout</button>
                    <button class="quick-prompt text-xs bg-gray-100 hover:bg-gray-200 px-2 py-1 rounded transition-colors" data-prompt="What tasks do I have today?" tabindex="0">Today's tasks</button>
                </div>
            </div>
        </div>

        <!-- Typing Indicator -->
        <div id="typing-indicator" class="hidden px-4 pb-2">
            <div class="flex items-center gap-2 text-gray-500 text-sm">
                <div class="flex gap-1">
                    <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce"></div>
                    <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                    <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                </div>
                <span>AI is thinking...</span>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>